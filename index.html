<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Download and parse public files released by B3 and convert them
    into useful formats and data structures common to data analysis
    practitioners.">
<title>Download and Parse Public Data Released by B3 Exchange â€¢ rb3</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Download and Parse Public Data Released by B3 Exchange">
<meta property="og:description" content="Download and parse public files released by B3 and convert them
    into useful formats and data structures common to data analysis
    practitioners.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">rb3</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/Fetching-historical-future-rates.html">How to Compute Historical Rates from B3 Future Prices</a>
    <a class="dropdown-item" href="articles/Fetching-historical-yield-curve.html">Fetching Historical Yield Curve from B3</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/wilsonfreitas/rb3/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rb3">rb3<a class="anchor" aria-label="anchor" href="#rb3"></a>
</h1></div>
<!-- badges: start -->
<p><a href="https://www.b3.com.br" class="external-link">B3</a> is the main financial exchange in Brazil, offering support and access to trading systems for equity and fixed income markets. In its website you can find a vast number of datasets regarding prices and transactions for contracts available for trading at these markets, including:</p>
<ul>
<li>equities (unadjusted for corporate events)</li>
<li>futures</li>
<li>FII (Reits)</li>
<li>options</li>
<li>BDRs</li>
<li>historical yield curves (calculated from futures contracts)</li>
<li>B3 indexes composition</li>
</ul>
<p>Package <strong>rb3</strong> facilitates downloading and reading these datasets from <a href="https://www.b3.com.br" class="external-link">B3</a>, making it easy to consume it in R in a structured way. These datasets can be used in industry or academic studies.</p>
</div>
<div class="section level1">
<h1 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h1>
<p>The documentation is available in its <a href="https://wilsonfreitas.github.io/rb3/" class="external-link">pkgdown page</a>, where articles (vignettes) with real applications can be found.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rb3"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># github (Development branch)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"wilsonfreitas/rb3"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="yield-curve">Yield curve<a class="anchor" aria-label="anchor" href="#yield-curve"></a>
</h3>
<p>Download and use historical yield curve data with <code>yc_get</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wilsonfreitas/rb3" class="external-link">rb3</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>

<span class="va">df_yc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/yc_get.html">yc_mget</a></span><span class="op">(</span>
  first_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">255</span> <span class="op">*</span> <span class="fl">5</span>,
  last_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,
  by <span class="op">=</span> <span class="fl">255</span>
<span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  <span class="va">df_yc</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">forward_date</span>,
    y <span class="op">=</span> <span class="va">r_252</span>,
    group <span class="op">=</span> <span class="va">refdate</span>,
    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">refdate</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Yield Curves for Brazil"</span>,
    subtitle <span class="op">=</span> <span class="st">"Built using interest rates future contracts"</span>,
    caption <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span><span class="st">"Data imported using rb3 at {Sys.Date()}"</span><span class="op">)</span>,
    x <span class="op">=</span> <span class="st">"Forward Date"</span>,
    y <span class="op">=</span> <span class="st">"Annual Interest Rate"</span>,
    color <span class="op">=</span> <span class="st">"Reference Date"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-setup-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="futures-prices">Futures prices<a class="anchor" aria-label="anchor" href="#futures-prices"></a>
</h3>
<p>Get settlement future prices with <code>futures_get</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wilsonfreitas/rb3" class="external-link">rb3</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/futures_get.html">futures_mget</a></span><span class="op">(</span>
  first_date <span class="op">=</span> <span class="st">"2022-04-01"</span>,
  last_date <span class="op">=</span> <span class="st">"2022-04-29"</span>,
  by <span class="op">=</span> <span class="fl">5</span>
<span class="op">)</span>

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span>
  <span class="va">df</span> |&gt;
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">commodity</span> <span class="op">==</span> <span class="st">"DI1"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; Rows: 153</span>
<span class="co">#&gt; Columns: 8</span>
<span class="co">#&gt; $ refdate          &lt;date&gt; 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04-01, 2022-04~</span>
<span class="co">#&gt; $ commodity        &lt;chr&gt; "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1", "DI1"~</span>
<span class="co">#&gt; $ maturity_code    &lt;chr&gt; "J22", "K22", "M22", "N22", "Q22", "U22", "V22", "X22", "Z22", "F23", "G23", "H23", "J23", "N23", "V23", "F24", "J24", "N24", "V24", "F25", "J25", "N25"~</span>
<span class="co">#&gt; $ symbol           &lt;chr&gt; "DI1J22", "DI1K22", "DI1M22", "DI1N22", "DI1Q22", "DI1U22", "DI1V22", "DI1X22", "DI1Z22", "DI1F23", "DI1G23", "DI1H23", "DI1J23", "DI1N23", "DI1V23", "D~</span>
<span class="co">#&gt; $ price_previous   &lt;dbl&gt; 99999.99, 99172.50, 98159.27, 97181.87, 96199.14, 95137.64, 94174.49, 93265.23, 92365.48, 91404.64, 90434.90, 89662.14, 88719.94, 86306.50, 84065.98, 82~</span>
<span class="co">#&gt; $ price            &lt;dbl&gt; 100000.00, 99172.31, 98160.23, 97185.43, 96210.42, 95159.25, 94209.42, 93314.08, 92422.80, 91472.04, 90513.73, 89751.01, 88821.78, 86457.18, 84241.81, 8~</span>
<span class="co">#&gt; $ change           &lt;dbl&gt; 0.01, -0.19, 0.96, 3.56, 11.28, 21.61, 34.93, 48.85, 57.32, 67.40, 78.83, 88.87, 101.84, 150.68, 175.83, 275.55, 370.18, 423.00, 452.44, 477.65, 497.68,~</span>
<span class="co">#&gt; $ settlement_value &lt;dbl&gt; 0.01, 0.19, 0.96, 3.56, 11.28, 21.61, 34.93, 48.85, 57.32, 67.40, 78.83, 88.87, 101.84, 150.68, 175.83, 275.55, 370.18, 423.00, 452.44, 477.65, 497.68, ~</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="equity-data">Equity data<a class="anchor" aria-label="anchor" href="#equity-data"></a>
</h3>
<p>Equity closing data (without <strong>ANY</strong> price adjustments) is available thru <code>cotahist_get</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wilsonfreitas/rb3" class="external-link">rb3</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wilsonfreitas/R-bizdays" class="external-link">bizdays</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'bizdays'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     offset</span>

<span class="co"># fix for ssl error (only in linux)</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html" class="external-link">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"sysname"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Linux"</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/set_config.html" class="external-link">set_config</a></span><span class="op">(</span>
    <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/config.html" class="external-link">config</a></span><span class="op">(</span>ssl_verifypeer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bizdays/man/adjust.date.html" class="external-link">preceding</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"Brazil/ANBIMA"</span><span class="op">)</span> <span class="co"># last business day</span>
<span class="va">ch</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cotahist_get.html">cotahist_get</a></span><span class="op">(</span><span class="va">date</span>, <span class="st">"daily"</span><span class="op">)</span>

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span>
  <span class="fu"><a href="reference/cotahist-extracts.html">cotahist_equity_get</a></span><span class="op">(</span><span class="va">ch</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; Rows: 382</span>
<span class="co">#&gt; Columns: 13</span>
<span class="co">#&gt; $ refdate               &lt;date&gt; 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 20~</span>
<span class="co">#&gt; $ symbol                &lt;chr&gt; "AALR3", "ABCB4", "ABEV3", "AERI3", "AESB3", "AFLT3", "AGRO3", "AGXY3", "ALLD3", "ALPA3", "ALPA4", "ALPK3", "ALSO3", "ALUP3", "ALUP4", "AMAR3", "AM~</span>
<span class="co">#&gt; $ open                  &lt;dbl&gt; 19.81, 16.16, 14.55, 3.83, 10.79, 9.06, 31.60, 9.23, 13.35, 19.52, 22.28, 3.79, 19.65, 8.81, 8.66, 2.17, 28.52, 22.93, 5.02, 29.29, 12.36, 80.70, 1~</span>
<span class="co">#&gt; $ high                  &lt;dbl&gt; 19.89, 16.55, 14.67, 3.93, 10.81, 9.50, 32.40, 9.78, 13.35, 19.52, 22.46, 3.80, 19.90, 8.90, 8.94, 2.28, 29.98, 24.62, 5.47, 32.98, 13.24, 84.32, 1~</span>
<span class="co">#&gt; $ low                   &lt;dbl&gt; 19.43, 16.06, 14.45, 3.72, 10.64, 9.06, 31.54, 9.21, 12.30, 18.83, 21.70, 3.65, 19.48, 8.52, 8.60, 2.17, 28.52, 22.74, 5.01, 29.29, 12.24, 80.59, 1~</span>
<span class="co">#&gt; $ close                 &lt;dbl&gt; 19.75, 16.54, 14.54, 3.75, 10.64, 9.35, 32.06, 9.33, 12.52, 19.25, 21.80, 3.80, 19.69, 8.70, 8.75, 2.23, 29.75, 23.05, 5.38, 32.98, 13.00, 82.49, 1~</span>
<span class="co">#&gt; $ average               &lt;dbl&gt; 19.66, 16.38, 14.55, 3.80, 10.69, 9.38, 31.99, 9.50, 12.73, 19.12, 22.04, 3.75, 19.66, 8.72, 8.76, 2.23, 29.51, 23.52, 5.35, 31.46, 13.02, 82.75, 1~</span>
<span class="co">#&gt; $ best_bid              &lt;dbl&gt; 19.75, 16.45, 14.54, 3.74, 10.64, 9.35, 32.06, 9.33, 12.52, 19.05, 21.80, 3.77, 19.68, 8.70, 8.75, 2.22, 29.74, 23.04, 5.37, 29.66, 12.97, 82.48, 1~</span>
<span class="co">#&gt; $ best_ask              &lt;dbl&gt; 19.80, 16.54, 14.58, 3.75, 10.65, 9.47, 32.08, 9.70, 12.68, 19.50, 21.91, 3.80, 19.69, 8.72, 8.82, 2.23, 29.75, 23.05, 5.38, 32.98, 13.00, 82.58, 1~</span>
<span class="co">#&gt; $ volume                &lt;dbl&gt; 13692159, 10155477, 194865062, 13607948, 11877006, 16893, 17358541, 855837, 2366674, 68854, 115741119, 68319, 19234179, 136976, 115709, 11718265, 3~</span>
<span class="co">#&gt; $ traded_contracts      &lt;int&gt; 696300, 619700, 13385100, 3571700, 1110400, 1800, 542500, 90000, 185800, 3600, 5251300, 18200, 978000, 15700, 13200, 5237300, 1162100, 11745000, 27~</span>
<span class="co">#&gt; $ transactions_quantity &lt;int&gt; 2873, 4115, 29016, 7499, 4533, 16, 3363, 492, 633, 19, 23648, 85, 3961, 115, 91, 5106, 7014, 27959, 6067, 157, 3744, 6423, 13391, 61, 4369, 11, 84,~</span>
<span class="co">#&gt; $ distribution_id       &lt;int&gt; 102, 140, 125, 101, 102, 119, 112, 101, 103, 231, 231, 101, 102, 113, 113, 113, 102, 101, 107, 105, 103, 142, 104, 105, 101, 101, 119, 119, 101, 12~</span></code></pre></div>
<p>Funds data</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span>
  <span class="fu"><a href="reference/cotahist-extracts.html">cotahist_funds_get</a></span><span class="op">(</span><span class="va">ch</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; Rows: 359</span>
<span class="co">#&gt; Columns: 13</span>
<span class="co">#&gt; $ refdate               &lt;date&gt; 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 20~</span>
<span class="co">#&gt; $ symbol                &lt;chr&gt; "ABCP11", "AFHI11", "AFOF11", "AIEC11", "ALMI11", "ALZR11", "APTO11", "ARCT11", "ARRI11", "ATSA11", "BARI11", "BBFI11B", "BBFO11", "BBPO11", "BBRC1~</span>
<span class="co">#&gt; $ open                  &lt;dbl&gt; 72.48, 99.52, 89.00, 78.55, 950.00, 115.19, 10.22, 106.05, 94.99, 88.10, 99.61, 1975.48, 71.50, 81.00, 95.99, 63.85, 81.01, 106.51, 9.87, 86.50, 97~</span>
<span class="co">#&gt; $ high                  &lt;dbl&gt; 72.78, 100.80, 89.49, 78.99, 951.00, 115.98, 10.50, 106.39, 95.93, 89.00, 100.00, 1999.98, 72.46, 81.67, 100.01, 65.80, 81.83, 107.40, 9.87, 86.50,~</span>
<span class="co">#&gt; $ low                   &lt;dbl&gt; 72.16, 99.50, 88.52, 78.55, 930.00, 115.19, 10.22, 105.95, 94.71, 88.10, 99.61, 1900.02, 70.99, 80.65, 95.99, 63.85, 80.73, 106.48, 9.61, 86.50, 96~</span>
<span class="co">#&gt; $ close                 &lt;dbl&gt; 72.24, 100.65, 89.00, 78.93, 950.00, 115.70, 10.31, 106.00, 94.78, 89.00, 99.99, 1958.94, 72.39, 80.90, 97.97, 65.35, 81.35, 107.40, 9.75, 86.50, 9~</span>
<span class="co">#&gt; $ average               &lt;dbl&gt; 72.38, 100.13, 89.02, 78.90, 947.15, 115.63, 10.48, 106.15, 95.10, 88.60, 99.93, 1949.91, 71.40, 81.12, 97.87, 65.18, 81.43, 106.75, 9.70, 86.50, 9~</span>
<span class="co">#&gt; $ best_bid              &lt;dbl&gt; 72.24, 100.60, 88.99, 78.91, 930.50, 115.69, 10.38, 106.00, 94.78, 88.07, 99.98, 1935.00, 71.51, 80.84, 97.96, 65.35, 81.25, 107.32, 9.74, 80.01, 9~</span>
<span class="co">#&gt; $ best_ask              &lt;dbl&gt; 72.53, 100.65, 89.00, 78.99, 951.00, 115.70, 10.50, 106.10, 94.82, 90.53, 99.99, 1958.95, 72.39, 80.90, 97.97, 65.78, 81.35, 107.40, 9.75, 86.00, 9~</span>
<span class="co">#&gt; $ volume                &lt;dbl&gt; 67023.89, 1305373.39, 130064.77, 57283.07, 79561.11, 995972.30, 33367.53, 3268860.08, 234137.10, 3189.60, 604620.93, 300286.42, 554444.63, 1218968.~</span>
<span class="co">#&gt; $ traded_contracts      &lt;int&gt; 926, 13036, 1461, 726, 84, 8613, 3181, 30794, 2462, 36, 6050, 154, 7765, 15026, 1075, 50039, 2497, 10446, 14900, 50, 123, 9541, 55291, 1, 20, 762, ~</span>
<span class="co">#&gt; $ transactions_quantity &lt;int&gt; 231, 542, 79, 129, 77, 1039, 99, 3989, 221, 3, 721, 86, 191, 1316, 106, 7695, 306, 1060, 803, 1, 15, 1564, 2694, 1, 3, 94, 220, 146, 1, 3289, 3212,~</span>
<span class="co">#&gt; $ distribution_id       &lt;int&gt; 314, 113, 113, 120, 250, 154, 105, 126, 131, 136, 137, 302, 116, 214, 228, 252, 185, 190, 106, 123, 114, 120, 116, 102, 225, 216, 211, 116, 134, 13~</span></code></pre></div>
<p>BDRs data</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span>
  <span class="fu"><a href="reference/cotahist-extracts.html">cotahist_bdrs_get</a></span><span class="op">(</span><span class="va">ch</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; Rows: 509</span>
<span class="co">#&gt; Columns: 13</span>
<span class="co">#&gt; $ refdate               &lt;date&gt; 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 20~</span>
<span class="co">#&gt; $ symbol                &lt;chr&gt; "A1AP34", "A1BB34", "A1CR34", "A1DM34", "A1EE34", "A1EG34", "A1EN34", "A1EP34", "A1IV34", "A1KA34", "A1LB34", "A1LG34", "A1LK34", "A1LL34", "A1LN34~</span>
<span class="co">#&gt; $ open                  &lt;dbl&gt; 67.80, 36.71, 65.10, 443.76, 234.24, 26.28, 294.30, 252.43, 29.28, 41.40, 1154.00, 344.19, 230.00, 65.00, 32.22, 460.00, 330.72, 563.40, 48.51, 138~</span>
<span class="co">#&gt; $ high                  &lt;dbl&gt; 67.80, 36.71, 65.10, 443.76, 235.20, 26.28, 295.80, 252.43, 29.28, 41.41, 1154.00, 349.14, 230.00, 66.11, 32.22, 488.25, 331.52, 563.47, 48.51, 138~</span>
<span class="co">#&gt; $ low                   &lt;dbl&gt; 66.79, 36.23, 64.56, 430.00, 233.77, 26.10, 293.69, 249.52, 29.28, 41.37, 1154.00, 344.19, 230.00, 64.74, 32.19, 454.51, 330.72, 560.99, 48.51, 138~</span>
<span class="co">#&gt; $ close                 &lt;dbl&gt; 66.79, 36.25, 64.62, 430.00, 235.00, 26.10, 295.50, 250.00, 29.28, 41.37, 1154.00, 349.14, 230.00, 64.74, 32.19, 477.90, 331.52, 560.99, 48.51, 138~</span>
<span class="co">#&gt; $ average               &lt;dbl&gt; 67.43, 36.31, 64.68, 434.09, 234.62, 26.22, 294.66, 250.61, 29.28, 41.39, 1154.00, 345.01, 230.00, 65.53, 32.20, 475.33, 331.38, 563.39, 48.51, 138~</span>
<span class="co">#&gt; $ best_bid              &lt;dbl&gt; 0.00, 0.00, 54.00, 0.00, 0.00, 0.00, 0.00, 0.00, 29.31, 34.75, 0.00, 329.01, 0.00, 61.75, 0.00, 435.00, 0.00, 529.64, 0.00, 0.00, 0.00, 13.04, 0.00~</span>
<span class="co">#&gt; $ best_ask              &lt;dbl&gt; 0.00, 38.00, 0.00, 0.00, 0.00, 27.43, 0.00, 0.00, 31.00, 0.00, 1300.00, 925.00, 0.00, 0.00, 42.48, 480.00, 0.00, 0.00, 0.00, 200.00, 0.00, 15.10, 0~</span>
<span class="co">#&gt; $ volume                &lt;dbl&gt; 3709.04, 435.83, 14619.84, 8247.78, 14781.36, 183.54, 14438.53, 16039.06, 58.56, 124.18, 1154.00, 2070.09, 1610.00, 116261.00, 96.60, 2929000.31, 6~</span>
<span class="co">#&gt; $ traded_contracts      &lt;int&gt; 55, 12, 226, 19, 63, 7, 49, 64, 2, 3, 1, 6, 7, 1774, 3, 6162, 20, 812, 5, 44, 11, 4, 50, 1619, 9, 1, 97, 1721, 11580, 144, 4, 1410, 278595, 88, 25,~</span>
<span class="co">#&gt; $ transactions_quantity &lt;int&gt; 6, 12, 38, 5, 36, 5, 46, 45, 1, 3, 1, 3, 1, 15, 3, 151, 5, 3, 5, 1, 2, 4, 43, 19, 3, 1, 3, 115, 38, 1, 1, 23, 2639, 5, 13, 15, 40, 266, 16, 1536, 3~</span>
<span class="co">#&gt; $ distribution_id       &lt;int&gt; 110, 102, 106, 109, 109, 102, 110, 110, 106, 101, 109, 100, 101, 111, 100, 100, 110, 109, 103, 101, 100, 102, 109, 103, 100, 109, 100, 103, 100, 10~</span></code></pre></div>
<p>Equity options</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span>
  <span class="fu"><a href="reference/cotahist-extracts.html">cotahist_equity_options_get</a></span><span class="op">(</span><span class="va">ch</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; Rows: 6,059</span>
<span class="co">#&gt; Columns: 14</span>
<span class="co">#&gt; $ refdate               &lt;date&gt; 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 2022-05-13, 20~</span>
<span class="co">#&gt; $ symbol                &lt;chr&gt; "ABEVR155", "ABEVR180", "ABEVX20", "ABEVR154", "ABEVQ127", "ABEVS162", "ALPAS230", "ALSOS210", "AMARF350", "AMARB300", "AMARE199", "AMARQ350", "AMB~</span>
<span class="co">#&gt; $ type                  &lt;fct&gt; Put, Put, Put, Put, Put, Put, Put, Put, Call, Call, Call, Put, Call, Put, Call, Put, Call, Call, Call, Call, Call, Call, Call, Call, Call, Call, Ca~</span>
<span class="co">#&gt; $ strike                &lt;dbl&gt; 14.97, 17.47, 19.47, 15.47, 12.79, 16.29, 23.00, 20.62, 3.50, 3.00, 2.00, 3.50, 31.70, 31.70, 25.31, 62.81, 32.31, 32.56, 37.81, 39.81, 38.31, 36.3~</span>
<span class="co">#&gt; $ maturity_date         &lt;date&gt; 2022-06-17, 2022-06-17, 2023-12-15, 2022-06-17, 2022-05-20, 2022-07-15, 2022-07-15, 2022-07-15, 2022-06-17, 2024-02-16, 2022-05-20, 2022-05-20, 20~</span>
<span class="co">#&gt; $ open                  &lt;dbl&gt; 0.69, 2.72, 3.30, 0.97, 0.01, 1.62, 1.80, 1.53, 0.03, 0.60, 0.28, 1.49, 0.68, 2.55, 1.55, 35.50, 0.04, 0.04, 0.01, 0.02, 0.02, 0.06, 0.08, 0.35, 0.~</span>
<span class="co">#&gt; $ high                  &lt;dbl&gt; 0.71, 2.81, 3.30, 1.03, 0.02, 1.62, 2.20, 1.53, 0.03, 0.60, 0.28, 1.49, 0.68, 2.55, 1.73, 35.50, 0.04, 0.04, 0.01, 0.02, 0.04, 0.06, 0.08, 0.35, 0.~</span>
<span class="co">#&gt; $ low                   &lt;dbl&gt; 0.59, 2.72, 3.30, 0.91, 0.01, 1.62, 1.80, 1.53, 0.03, 0.60, 0.26, 1.28, 0.68, 2.55, 1.14, 35.50, 0.04, 0.04, 0.01, 0.02, 0.02, 0.06, 0.08, 0.28, 0.~</span>
<span class="co">#&gt; $ close                 &lt;dbl&gt; 0.60, 2.81, 3.30, 0.92, 0.01, 1.62, 2.10, 1.53, 0.03, 0.60, 0.26, 1.28, 0.68, 2.55, 1.14, 35.50, 0.04, 0.04, 0.01, 0.02, 0.04, 0.06, 0.08, 0.30, 0.~</span>
<span class="co">#&gt; $ average               &lt;dbl&gt; 0.65, 2.74, 3.30, 0.96, 0.01, 1.62, 2.06, 1.53, 0.03, 0.60, 0.26, 1.39, 0.68, 2.55, 1.56, 35.50, 0.04, 0.04, 0.01, 0.02, 0.03, 0.06, 0.08, 0.31, 0.~</span>
<span class="co">#&gt; $ volume                &lt;dbl&gt; 414290, 541506, 66000, 201996, 1057, 81000, 825, 2295, 6, 60, 396, 2646, 68, 255, 6409, 287550, 4, 28, 4, 800, 1200, 300, 40, 822, 787, 233, 104, 5~</span>
<span class="co">#&gt; $ traded_contracts      &lt;int&gt; 637000, 197000, 20000, 209700, 105400, 50000, 400, 1500, 200, 100, 1500, 1900, 100, 100, 4100, 8100, 100, 700, 400, 40000, 40000, 5000, 500, 2600, ~</span>
<span class="co">#&gt; $ transactions_quantity &lt;int&gt; 99, 6, 1, 172, 13, 1, 4, 1, 1, 1, 2, 8, 1, 1, 7, 1, 1, 1, 2, 3, 3, 1, 1, 5, 7, 9, 2, 1, 1, 4, 2, 1, 28, 4, 8, 10, 8, 8, 6, 4, 1, 3, 1, 8, 1, 3, 2, ~</span>
<span class="co">#&gt; $ distribution_id       &lt;int&gt; 124, 124, 124, 125, 125, 125, 231, 101, 113, 113, 113, 113, 101, 101, 100, 100, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 10~</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="template-system">Template System<a class="anchor" aria-label="anchor" href="#template-system"></a>
</h2>
<p>One important part of <code>rb3</code> infrastructure is its <code>Template System</code>.</p>
<p>All datasets handled by the rb3 package are configured in a template, that is an YAML file. The template brings many information regarding the datasets, like its description and its metadata that describes its columns, their types and how it has to be parsed. The template fully describes its dataset.</p>
<p>Once you have the template implemented you can fetch and read downloaded data directly with the functions <code>download_marketdata</code> and <code>read_marketdata</code>.</p>
<p>For examples, letâ€™s use the template <code>FPR</code> to download and read data regarding primitive risk factor used by B3 in its risk engine.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_marketdata.html">download_marketdata</a></span><span class="op">(</span><span class="st">"FPR"</span>, refdate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2022-05-10"</span><span class="op">)</span><span class="op">)</span>
<span class="va">f</span>
<span class="co">#&gt; [1] "C:/Users/wilso/AppData/Local/Temp/RtmpE1tWHO/rb3-cache/FPR-7a2422cc97221426a3b2bd4419215481/FP220510/FatoresPrimitivosRisco.txt"</span></code></pre></div>
<p><code>download_marketdata</code> returns the path for the downloaded file.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_marketdata.html">read_marketdata</a></span><span class="op">(</span><span class="va">f</span>, <span class="st">"FPR"</span><span class="op">)</span>
<span class="va">fpr</span>
<span class="co">#&gt; $Header</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   tipo_registro data_geracao_arquivo</span>
<span class="co">#&gt;           &lt;int&gt; &lt;date&gt;              </span>
<span class="co">#&gt; 1             1 2022-05-10          </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Data</span>
<span class="co">#&gt; # A tibble: 3,204 x 11</span>
<span class="co">#&gt;    tipo_registro id_fpr nome_fpr formato_variacao id_grupo_fpr id_camara_indicador id_instrumento_indicador origem_instrumento  base base_interpolacao criterio_capitalizacao</span>
<span class="co">#&gt;            &lt;int&gt;  &lt;int&gt; &lt;chr&gt;    &lt;fct&gt;                   &lt;dbl&gt; &lt;chr&gt;                                  &lt;dbl&gt;              &lt;int&gt; &lt;int&gt;             &lt;int&gt;                  &lt;int&gt;</span>
<span class="co">#&gt;  1             2   1422 VLRAPT4  Basis Points                1 BVMF                            200000008810                  8     0                 0                      0</span>
<span class="co">#&gt;  2             2   1423 VLPETR3  Basis Points                1 BVMF                            200000008803                  8     0                 0                      0</span>
<span class="co">#&gt;  3             2   1424 VLSEER3  Basis Points                1 BVMF                            200000008818                  8     0                 0                      0</span>
<span class="co">#&gt;  4             2   1426 VLJBSS3  Basis Points                1 BVMF                            200000008780                  8     0                 0                      0</span>
<span class="co">#&gt;  5             2   1427 VLKLBN11 Basis Points                1 BVMF                            200000008781                  8     0                 0                      0</span>
<span class="co">#&gt;  6             2   1428 VLITUB3  Basis Points                1 BVMF                            200000463163                  8     0                 0                      0</span>
<span class="co">#&gt;  7             2   1429 VLITSA4  Basis Points                1 BVMF                            200000008777                  8     0                 0                      0</span>
<span class="co">#&gt;  8             2   1430 VLHYPE3  Basis Points                1 BVMF                            200000008773                  8     0                 0                      0</span>
<span class="co">#&gt;  9             2   1431 VLGRND3  Basis Points                1 BVMF                            200000008770                  8     0                 0                      0</span>
<span class="co">#&gt; 10             2   1433 VLUGPA3  Basis Points                1 BVMF                            200000008830                  8     0                 0                      0</span>
<span class="co">#&gt; # ... with 3,194 more rows</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "parts"</span></code></pre></div>
<p><code>read_marketdata</code> parses the downloaded file according to the metadata configured in the template <code>FPR</code>.</p>
<p>Here it follows a view of the <code>show_templates</code> adding that lists the available templates.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/show_templates.html">show_templates</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/rb3-templates.png" width="100%"></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=rb3" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/wilsonfreitas/rb3/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/wilsonfreitas/rb3/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rb3</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Wilson Freitas <br><small class="roles"> Author, maintainer </small>  </li>
<li>Marcelo Perlin <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://app.codecov.io/gh/wilsonfreitas/rb3?branch=main" class="external-link"><img src="https://codecov.io/gh/wilsonfreitas/rb3/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/wilsonfreitas/rb3/actions" class="external-link"><img src="https://github.com/wilsonfreitas/rb3/workflows/R-CMD-check/badge.svg" alt="R build (rcmdcheck)"></a></li>
<li><a href="https://CRAN.R-project.org/package=rb3" class="external-link"><img src="https://www.r-pkg.org/badges/version/rb3" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=rb3" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/rb3"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Wilson Freitas, Marcelo Perlin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
